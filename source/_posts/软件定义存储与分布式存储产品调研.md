title: "软件定义存储与分布式存储产品调研"
date: 2016-11-29 11:34:50
tags: [GlusterFS,Ceph,SDS,分布式存储]

---

## 1.概念与简介

本文对主流企业的软件定义存储进行基本的调研，主要工作集中于展示这些产品的功能及功能的对比。文章末尾会附上相关产品的技术白皮书/官方网站。

软件定义存储的定义到目前为止还存在着争议，各大企业都结合自己的产品对这一概念进行解释，不过总的思路都是：更多地由软件来驱动并控制硬件资源。

<!--more-->

一般的云计算和虚拟化公司（如VMWare之类的企业）认为：
软件定义的存储是将工业标准服务器的存储提供出来并通过软件控制层面实现存储的自动化和池化。它将存储的置备和管理的方法简化到了极致，并利用工业标准服务器的存储大大降低了成本。

Gartner在最新的报告中（2016年度）将SDS拆分成管理SDS和基础架构SDS：基础架构SDS典型如EMC ScaleIO，华为FusionStorage，这个是属于ServerSAN的范畴，而管理SDS典型如EMC ViPR，华为OceanStor DJ，是属于存储资源编排的范畴。这个拆分使得对存储产品的功能的划分变得更加简单。对于存储产品线及其庞大的大型企业，本文将主要选取这两种类型的产品进行介绍。


## 2.企业产品

### 2.1 EMC

#### ScaleIO

ScaleIO 是一种分布式存储（将数据分散存储在多台独立的设备上的存储）软件,能够将服务器内的硬盘或闪存池化，并把它作为可扩展的块存储来使用。

软件功能：

* 可写快照
* 轻量级静态数据加密
* 安全的专用LUN
* 多租户（数据分隔，数据加密）
* 质量控制（按应用限制IOPS）
* 可以利用任何HDDs，SSDs，PCIE闪存卡和共享存储
* 可以安装在任何物理/虚拟应用服务器
* 自动调整（动态增加节点或磁盘，自动执行数据迁移/平衡操作）
* 设置保护域
* 存储池（性能分隔，不同设备类型分层管理）

#### ViPR

EMC® ViPR® 控制器是存储自动化软件，能够对存储进行集中和自动化处理并将其转变成为一个简单、可扩展的平台。它对资源进行抽象化和池化处理后形成一个存储平台，然后通过自助服务目录按需提供策略驱动型自动存储服务。

产品功能：

* 在整个存储环境中跟踪容量消耗
* 监视并报告从主机到存储的性能趋势
* 查看物理资源和关系依赖性
* 按服务级别优化按存储容量使用计费报告
* 块存储池
    * 物理存储卷的创建、扩展、快照、删除
* 文件存储池
    * 对文件系统的创建、快照、删除
* 对象存储池
    * Bucket 的创建、修改以及删除

支持的存储平台及环境：

* EMC 存储：Data Domain®、Isilon®、ScaleIO、VMAX®、VNX®、VNXe3200、XtremIO®
* 融合基础架构：VCE® Vblock 系统
* 第三方存储：HDS、NetApp、HP、IBM、Dell、LeftHand、Oracle、SolidFire
* 数据保护技术：Hitachi 快照、IBM 快照、RecoverPoint®、SRDF®、VPLEX®
* 云堆栈：Microsoft、OpenStack、VMware
* 该平台可通过开放式的基于 REST 的 API以逻辑存储池形式进行访问：
    * 与更高级别的管理自动化解决方案进行集成
    * 通过 ViPR Plug-In for vRealize Orchestrator 和 ViPR Management Pack for vRealize Operations 与 VMware 集成


### 2.2 华为

#### FusionStorage

FusionStorage早期是为融合基础设施FusionCube打造的分布式存储软件产品，适合计算和存储融合的系统。

华为FusionStorage是为了满足云计算数据中心存储基础设施需求而设计的一种分布式块存储软件，可以将通用X86服务器的本地HDD、SSD等存储介质通过分布式技术组织成一个大规模存储资源池，对上层的应用和虚拟机提供工业界标准的SCSI和iSCSI接口，类似一个虚拟的分布式SAN存储。

产品功能：

* 分布式RAID（多副本）
* 快照（使用SCSI存储接口）
    * 创建
    * 查询
    * 删除
    * 备份
    * 还原
* 精简配置（当用户对卷进行写操作时，系统才分配实际物理空间，FusionStorage仅处理虚拟卷空间和实际物理空间之前的映射关系，对性能无影响）
* 链接克隆（使用 SCSI 存储接口时，FusionStorage基于增量快照提供链接克隆机制。即基于一个快照，创建出多个克隆卷，各克隆卷刚创建出来时数据内容和快照中的数据内容一致，后续对于克隆卷的修改不会影响到原始的快照和其他克隆卷。）
* 可靠性
    * 快速数据重建
    * 掉电保护
* 安全保护机制
    * 网络安全（网络平面隔离，通信端口）
    * 基础设施安全（操作系统安全，数据库加固，安全补丁）
    * 管理安全（日志管理，账号密码管理）
    * 接入安全（安全认证）
    * 传输安全（HTTPS）
    * 存储安全（分片存储，用户数据隔离，AES-256加密，加密上传）


#### OceanStor DJ

OceanStor系列的存储产品还包括一些软硬件一体的产品，其中OceanStor DJ是业务驱动的存储控制软件，统一管理存储资源，自由编排服务目录，提供自动部署的存储和数据应用服务，提升数据中心运营效率。最大可管理500套存储，为用户提供自动化的块、文件、复制、备份等存储服务目录。并支持向云数据中心平滑演进，保护客户的既有投资。

OceanStor DJ基于OpenStack开放架构和RESTful标准化接口，不改变现有网络结构就可以接入数据中心。既可以独立部署，作为存储虚拟化平台，提供存储设备统一管理、存储资源自动化分配和保护等服务；也可以融入云数据中心，作为存储虚拟化和服务化的增强组件，配合华为和第三方运维平台为数据中心提供自动化的存储资源管理、分配和保护等服务，帮助数据中心实现全流程的自动化服务，提升运营效率。

OceanStor系统的一个重要特点是其本身不提供任何存储——存储系统的功能依赖于底层的存储设备。

产品功能：

* 块存储服务
    * 创建卷服务
    * 创建卷复制服务
    * 创建卷备份
    * 为OpenStack提供存储
    * 存储调度
* 文件存储服务
* 数据保护服务
    * 卷复制服务
    * 卷备份服务（OceanStor DJ提供单一OpenStack环境下，基于存储设备复制能力的主备数据复制）
        * 面向传统数据中心融合资源池场景下的数据备份
        * 面向FusionSphere私有云数据中心场景下的数据备份
* 基于workload的应用存储服务(OceanStor DJ基于增强后的OpenStack Heat服务，实现存储服务定制编排，能够基于行业workload，提供自动化的应用存储服务模板。)
* 高可靠性
    * 管理服务器 HA
    * 数据库数据准实时同步
    * 系统健壮性设计
    * 故障收集和告警上报
* 安全性
    * 数据安全
    * Web安全
    * 业务运行安全

实现：

OceanStor DJ使用块存储服务等级来定义卷的各类能力或特性，例如卷所在的虚拟资源池、是否Thin分配、是否使用分层存储、分层存储的迁移策略、QoS设定等OceanStor DJ利用扩展后的OpenStack Cinder服务，实现存储资源池化和资源调度提供一个存储资源池化调度层，当用户提出存储资源要求时，调度层根据底层存储设备的能力匹配资源要求，寻找合适的存储设备提供存储空间，这个过程称之为调度。

OceanStor DJ支持通过标准API接口，将文件存储服务集成到用户自己的上层运维管理平台上。

该服务模板以格式化的文本描述应用所需存储资源的各类参数，例如卷数量、卷容量、卷的性能要求、带宽要求、卷所在的存储池、所属物理地域、所属存储网络等。OceanStor DJ通过基于OpenStack增强后的Heat服务，自动读取服务模板中的内容，并根据其描述的各类参数自动调用相应的服务（例如Cinder、OM Service）创建资源。

### 2.3 H3C

#### ONEStor

ONEStor基于Ceph系统进行二次开发和优化（http://www.h3c.com.cn/About_H3C/News_Media/News_Media/Company_News/201512/903472_30008_0.htm）

H3C ONEStor 存储系统采用全分布式的架构：分布式管理集群，分布式哈希数据分布算法，分布式无状态客户端、分布式 Cache 等，这种架构为存储系统的可靠性、可用性、自动运维、高性能等方面提供了有力保证。

产品功能：

* 存储集群自动化快速部署
    * 批量部署
    * 单节点增减
    * 单磁盘增减
* 自动监控报警系统
* 可根据不同硬件能力，灵活地对集群中的节点进行配置部署
* 方便地进行故障域隔离，以及对数据存储位置进行灵活选择
* 自动化动化的数据均衡能力，增删节点或者节点故障时，自动进行数据恢复
* 提供块、对象、文件等多种不同的存储接口

应用场景：

* 云计算虚拟化场景
* 虚拟桌面应用
* 备份系统
* 企业云网盘
* H3Cloud OS 云管理平台/Openstack 后端存储

### 2.4 深信服

### aSAN存储虚拟化

aSAN 是基亍分布式文件系统Glusterfs开发的存储虚拟化产品（深信服融合解决方案_技术白皮书）


* SSD读写缓存加速
* 多副本机制保障
* 故障自动重构
* 自动精简配置
* 管理界面
    * 详情状态
    * 虚拟ISCSI磁盘
    * 虚拟共享盘
    * 配置
    * 权限

### 2.5 其他厂家

#### SandStone EBS（SandStone）

产品功能：

* 采用了多副本冗余机制，基于策略配置
* 传统阵列的磁盘可靠性检测和管理机制
    * 括错误码识别与自动处理
    * 坏道隔离
    * 慢盘检测

* 满足支持 VMWare VAAI 加速、Hyper-V ODX 加速、KVM-QEMU 垂直优化以及 OpenStack Cinder 接口
* 通过标准 iSCSI 协议或者对象存储接口访问虚拟存储资源池
* 支持S3/SWIFT对象接口
* 分布式快照
* SSD加速
* 数据迁移
* 多路径存储服务（故障时自动切换到其他正常节点和IO路径）
* 精简配置
* 并行迁移
* 硬件感知
* 集群故障自愈
* 存储管理
    * 资源监控
    * 集中式安装
    * 在线升级
    * 告警监控
    * 日志管理
    * 数据盘漫游
    * 硬盘灯定位
    * 部件更换

#### TaoCloud XDFS(大道云行)
该系统基于GlusterFS(出处：http://www.taocloudx.com/index.php?a=shows&catid=16&id=36)

产品功能：

* 共享存储
* 弹性扩展
* 提供CIFS/NFS，POSIX，API，OpenStackDocker接口
* 存储高可用
    * 多副本
    * 纠删码
    * SAN+HA
* 远程复制
    * 支持LAN，WAN，Internet方式
* 系统管理
    * 配置管理
    * 用户管理
    * 权限管理
    * 性能监控
    * 事件日志

#### PhegData（天玑数据）

产品功能：

* POSIX 接口
* 数据隔离与交互
* 数据动态迁移
* 动态在线扩展

## 3.小结

目前国内的大部分分布式存储产品都是基于Ceph以及GlusterFS等二次开发而成，二次开发的内容主要集中在管理界面，性能优化等方面，有部分厂商根据特定的需求实现了一些接口扩展,快照优化等功能。
于此同时，存储领域的前进方向于新产品的设计仍然由EMC，HP，IBM等国外厂商所把控。


## 附录

华为FusionStorage分布式存储系统（参见：华为FusionStorage 3.30技术白皮书）
http://e.huawei.com/cn/products/cloud-computing-dc/cloud-computing/fusionstorage/fusionstorage

华为OceanStor DJ业务驱动存储控制软件
http://e.huawei.com/cn/products/cloud-computing-dc/storage/massive-storage/oceanstor-dj

EMC SCALE IO
http://china.emc.com/storage/scaleio/index.htm

EMC ViPR Controller
http://china.emc.com/products/storage/software-defined-storage/vipr-controller.htm

深信服超融合架构解决方案
http://www.sangfor.com.cn/product/virtualization-hci.html